format = "projecttypes/v1"
id = "58b39367-e10b-418e-9455-e003599a49de"
created = "2024-02-21T14:53:41.334592Z"
updated = "2024-02-22T08:55:59.049440Z"
name = "HTB CWEE Report v1.0"
language = "en-US"
status = "finished"
tags = []
finding_field_order = [
    "title",
    "cwe",
    "cvss",
    "affected_components",
    "references",
    "summary",
    "impact",
    "description",
    "recommendation",
]
default_notes = []
report_template = """
<div id="header" data-sysreptor-generated="page-header">
    <div id="header-left">
        <img id="header-logo" src="/assets/name/logo-transparent.png" alt="logo" />
        <div id="header-text">
            <strong>HACK</strong>THE<strong>BOX</strong>
        </div>
    </div>
</div>


<div id="footer" data-sysreptor-generated="page-footer">
    <div id="footer-left"><em>CONFIDENTIAL</em></div>
    <div id="footer-center">{{ report.title }}</div>
</div>


<section id="page-cover" data-sysreptor-generated="page-cover">
    <img id="page-cover-logo" src="/assets/name/logo-transparent.png" alt="">
    <div id="page-cover-logo-title">
        <strong>HACK</strong>THE<strong>BOX</strong>
    </div>

    <div id="page-cover-title">
        <h1 id="page-cover-report-title">{{ report.title }}</h1>
        <h2>Report of Findings</h2>
        <h3>HTB Certified Web Exploitation Expert (CWEE) Exam Report</h3>
        <h3>Candidate Name: {{ report.candidate.a_name }}</h3>
    </div>

    <div id="page-cover-recipient">
        <h2>{{ formatDate(report.report_date, 'long') }}</h2>
        <h2>Version: {{ report.report_version }}</h2>
    </div>
    <pagebreak />
</section>


<table-of-contents id="toc" v-slot="{ items: tocItems }">
    <h1>Table of Contents</h1>
    <ul>
        <li v-for="item in tocItems" :class="'toc-level' + item.level">
            <ref :to="item.id" />
        </li>
    </ul>
    <pagebreak />
</table-of-contents>


<markdown>
    # Statement of Confidentiality {#SoC .in-toc.numbered}
    The contents of this document have been developed by Hack The Box. Hack The Box considers the contents of this document to be proprietary and business confidential information. This information is to be used only in the performance of its intended use. This document may not be released to another vendor, business partner or contractor without prior written consent from Hack The Box. Additionally, no portion of this document may be communicated, reproduced, copied or distributed without the prior consent of Hack The Box.

    The contents of this document do not constitute legal advice. Hack The Box's offer of services that relate to compliance, litigation or other legal interests are not intended as legal counsel and should not be taken as such. The assessment detailed herein is against a fictional company for training and examination purposes, and the vulnerabilities in no way affect Hack The Box external or internal infrastructure.

    <pagebreak />
</markdown>


<section>
    <div>
        <h1 id="contacts" class="in-toc numbered">Engagement Contacts</h1>
        <table>
            <tr>
                <th colspan="3" style="text-align: center">
                    {{ report.customer_short }} Contacts
                </th>
            </tr>
            <tr>
                <td><strong>Contact</strong></td>
                <td><strong>Title</strong></td>
                <td><strong>Contact Email</strong></td>
            </tr>
            <tr v-for="contact in report.customer_contacts">
                <td>{{ contact.a_name }}</td>
                <td>{{ contact.b_title }}</td>
                <td>{{ contact.c_email }}</td>
            </tr>
        </table>

        <table>
            <tr>
                <th colspan="3" style="text-align: center">
                    Assessor Contact
                </th>
            </tr>
            <tr>
                <td><strong>Assessor Name</strong></td>
                <td><strong>Title</strong></td>
                <td><strong>Assessor Contact Email</strong></td>
            </tr>
            <tr>
                <td>{{ report.candidate.a_name }}</td>
                <td>{{ report.candidate.b_title }}</td>
                <td>{{ report.candidate.c_email }}</td>
            </tr>
        </table>
    </div>
    <pagebreak />
</section>


<section>

    <h1 id="summary" class="in-toc numbered">Executive Summary</h1>
    <markdown :text="report.executive_summary" />

    <div>
        <h2 id="approach" class="in-toc numbered">Approach</h2>
        <markdown :text="report.approach" class="markdown-inline"/>
    </div>
    <pagebreak />
</section>

<section>
    <div>
    <h1 id="scope" class="in-toc numbered">Scope</h1>
    <markdown :text="report.scope" />
    </div>
    <pagebreak />
</section>

<section>
    <h1 id="web-application-security-assessment-summary" class="in-toc numbered">Web Application Security Assessment Summary</h1>

    <div>
        <h2 class="in-toc numbered">Summary of Findings</h2>
        <markdown>
            During the course of testing, {{ report.candidate.a_name }} uncovered a total of **{{ finding_stats.count_total }}** findings that pose a material risk to client’s web applications and systems. The below chart provides a summary of the findings by severity level.
        </markdown>
        <p>
            In the course of this penetration test
            <comma-and-join>
                <template #critical v-if="finding_stats.count_critical > 0"><strong class="risk-critical">{{ finding_stats.count_critical }} Critical</strong></template>
                <template #high v-if="finding_stats.count_high > 0"><strong class="risk-high">{{ finding_stats.count_high }} High</strong></template>
                <template #medium v-if="finding_stats.count_medium > 0"><strong class="risk-medium">{{ finding_stats.count_medium }} Medium</strong></template>
                <template #low v-if="finding_stats.count_low > 0"><strong class="risk-low">{{ finding_stats.count_low }} Low</strong></template>
                <template #info v-if="finding_stats.count_info > 0"><strong class="risk-info">{{ finding_stats.count_info }} Info</strong></template>
            </comma-and-join>
            vulnerabilities were identified:
        </p>

        <figure>
            <chart :width="15" :height="10" :config="{
                type: 'bar', 
                data: {
                    labels: ['Critical', 'High', 'Medium', 'Low', 'Info'],
                    datasets: [{
                        data: [
                            finding_stats.count_critical,
                            finding_stats.count_high,
                            finding_stats.count_medium,
                            finding_stats.count_low,
                            finding_stats.count_info
                        ],
                        backgroundColor: [
                            cssvar('--color-risk-critical'), 
                            cssvar('--color-risk-high'),
                            cssvar('--color-risk-medium'),
                            cssvar('--color-risk-low'),
                            cssvar('--color-risk-info')
                        ],
                    }],
                },
                options: {
                    scales: {
                        x: {
                            ticks: { color: 'white' }, // Specify the font color for the x-axis ticks
                            grid: { color: cssvar('--color-secondary') }, // Set the grid color for the x-axis
                        },
                        y: {
                            beginAtZero: true, 
                            ticks: { precision: 0, color: 'white' },
                            grid: { color: cssvar('--color-secondary') },  // Set the grid color for the y-axis
                        },
                    },
                    plugins: {legend: { display: false }},
                }, 
            }" />
            <figcaption>Distribution of identified vulnerabilities</figcaption>
        </figure>

        <markdown>
            Below is a high-level overview of each finding identified during the course of testing. These findings are covered in depth in the
            <ref to="findings">Technical Findings Details</ref> section of this report.
        </markdown>
        <table class="findings-list">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Severity Level</th>
                    <th>Finding Name</th>
                    <th align="center">Page</th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="finding in findings" class="table-row-link">
                    <td>
                        <ref :to="finding.id" class="ref-finding-number" />
                    </td>
                    <td :class="'risk-bg-' + finding.cvss.level">
                        <ref :to="finding.id">{{ finding.cvss.score}} ({{ lodash.capitalize(finding.cvss.level) }})</ref>
                    </td>
                    <td>
                        <ref :to="finding.id">{{ finding.title }}</ref>
                    </td>
                    <td align="center">
                        <ref :to="finding.id" class="ref-page" />
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <h2 id="assessment-overview-and-recommendations" class="in-toc numbered">Assessment Overview and Recommendations</h2>
    <markdown :text="report.assessment_overview_and_recommendations" />
    <pagebreak />
</section>

<section class="findings-list">
    <h1 id="findings" class="in-toc numbered">Technical Findings Details</h1>

    <div v-for="finding in findings">
        <h2 :id="finding.id" class="in-toc finding-number" :data-toc-title="finding.title">
            {{ finding.title }} -
            <span :class="'risk-' + finding.cvss.level">{{ lodash.capitalize(finding.cvss.level) }}</span>
        </h2>
        <table class="finding-header">
            <tr>
                <th :class="'risk-bg-' + finding.cvss.level">CWE</th>
                <td>
                    {{ finding.cwe.value || '-' }}
                </td>
            </tr>
            <tr>
                <th :class="'risk-bg-' + finding.cvss.level">CVSS 4.0</th>
                <td>
                    <span v-if="!finding.cvss.vector || finding.cvss.vector === 'n/a'">N/A</span>
                    <span v-else>{{ finding.cvss.score}} / {{ finding.cvss.vector }}</span>
                </td>
            </tr>
            <tr>
                <th :class="'risk-bg-' + finding.cvss.level">Description & Cause</th>
                <td>
                    <markdown :text="finding.summary" />
                </td>
            </tr>
            <tr>
                <th :class="'risk-bg-' + finding.cvss.level">Security Impact</th>
                <td>
                    <markdown :text="finding.impact" />
                </td>
            </tr>
            <tr v-if="finding.affected_components.length > 0">
                <th :class="'risk-bg-' + finding.cvss.level">Affected Component(s)</th>
                <td>
                    <span v-if="finding.affected_components.length === 0">-</span>
                    <span v-else-if="finding.affected_components.length === 1">{{ finding.affected_components[0]
                        }}</span>
                    <ul v-else :class="{'finding-systems': true, 'finding-systems-cols': finding.affected_components.length >= 4}">
                        <li v-for="c in finding.affected_components">{{ c }}</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <th :class="'risk-bg-' + finding.cvss.level">External References</th>
                <td>
                    <span v-if="finding.references.length === 0">-</span>
                    <span v-else-if="finding.references.length === 1">{{ finding.references[0] }}</span>
                    <ul v-else>
                        <li v-for="r in finding.references">{{ r }}</li>
                    </ul>
                </td>
            </tr>
        </table>

        <div v-if="finding.description">
            <h3>Detailed Walkthrough</h3>
            <markdown :text="finding.description" />
        </div>

        <div v-if="finding.recommendation">
            <h3>Patching and Remediation</h3>
            <markdown :text="finding.recommendation" />
        </div>

        <pagebreak />
    </div>
</section>

<section class="appendix">
    <h1 id="appendix" class="in-toc numbered">Appendix</h1>

    <div v-if="report.appendix_severities">
        <h2 class="in-toc numbered">Finding Severities</h2>
        <markdown :text="report.appendix_severities" />
        <pagebreak />
    </div>

    <div v-if="report.appendix_flags">
        <h2 class="in-toc numbered">Flags Discovered</h2>
        <markdown :text="report.appendix_flags" />
        <pagebreak />
    </div>

    <div v-for="appendix_additional_section in report.appendix_additional_sections">
        <h2 class="in-toc numbered">{{ appendix_additional_section.title }}</h2>
        <markdown :text="appendix_additional_section.content" />
        <pagebreak />
    </div>
</section>

<section>
    <div class="end-of-report">
        End of Report
    </div>
    <div class="end-of-report">
        This report was rendered<br>
        by <a href="https://docs.sysreptor.com/">SysReptor</a> with<br>
        <span style="color:red;">&hearts;</span><br>
    </div>
</section>
"""
report_styles = """
@import "/assets/global/base.css";

/* Define variables */
:root {
    --color-risk-critical: #E83221;
    --color-risk-high: #FF9300;
    --color-risk-medium: #ffc400;
    --color-risk-low: #4285F5;
    --color-risk-info: #00AE51;

    --color-highlight: #9FEF00;
    --color-secondary: #A6B0CB;
    
    --color-table-header: #9FEF00;
    --color-table-row-even: #A4B1CD;
    --color-table-row-odd: #BFC8DC;
    --color-table-content: #151515;

    --color-page-background: #161D2A;
}

@page {
    size: A4 portrait;
    margin: 35mm 20mm 25mm 20mm;
    background-color: var(--color-page-background);
}

/* Font */
html {
    font-family: "Noto Sans", sans-serif;
    font-size: 10pt;
    color: white;
}
h1, h2, h3, h4, h5, h6 {
    color: var(--color-highlight);
}

/* Justify text */
p {
    text-align: justify;
    text-align-last: start;
}

a {
  color: var(--color-secondary); /* Set the color of unvisited links */
  text-decoration: underline; /* Remove the underline from unvisited links */
}


/* Table styling */
table, th, td {
  border: 1px solid white;
}
th {
    background-color: var(--color-table-header);
    color: var(--color-table-content);
}
th, td {
    padding: 0.2em 0.5em 0.2em 0.5em;
}
tr.table-row-link td {
    padding: 0;
}
tr.table-row-link td a {
    display: block;
    padding: 0.2em 0.5em 0.2em 0.5em;
    color: inherit;
    text-decoration: none;
    font-style: inherit;
}
td.table-key {
    height: 3em;
    width: 10em;
}
tr{
    color: var(--color-table-content);
}
tr:nth-child(even) {
    background-color: var(--color-table-row-even)
}
tr:nth-child(odd) {
    background-color: var(--color-table-row-odd)
}


/* Code block styling */
pre code {
    border: 1px solid white;
    padding: 0.2em !important;
}
code {
    color: var(--color-highlight);
    background-color: inherit;
}

.code-important{
\tbackground-color: yellow;
    color: red;
    font-style: italic;
}

/* Footnotes */
@page {
  @footnote {
    border-top: 1px solid white;
  }
}
footnote {
  font-size: 8pt;
}

/* Classes for risk colors */
.risk-critical { color: var(--color-risk-critical) !important; font-weight: bold; }
.risk-high { color: var(--color-risk-high) !important; font-weight: bold; }
.risk-medium { color: var(--color-risk-medium) !important; font-weight: bold; }
.risk-low { color: var(--color-risk-low) !important; font-weight: bold; }
.risk-info { color: var(--color-risk-info) !important; font-weight: bold; }

.risk-bg-critical { background-color: var(--color-risk-critical) !important; color: white !important; }
.risk-bg-high { background-color: var(--color-risk-high) !important; }
.risk-bg-medium { background-color: var(--color-risk-medium) !important; }
.risk-bg-low { background-color: var(--color-risk-low) !important; }
.risk-bg-info { background-color: var(--color-risk-info) !important; }


/* Helper class for referencing page number */
.ref-page::before { 
    content: "" !important;
}
.ref-page .ref-title, .ref-finding-number .ref-title {
  display: none !important;
}
.ref-page::after {
  content: target-counter(attr(href), page) !important;
}
.ref-finding-number::before {
    content: target-counter(attr(href), finding-number);
}

.findings-list {
    counter-reset: finding-number;
}
.finding-number {
    color: white;
}
.finding-number::before {
    counter-increment: finding-number;
    content: counter(finding-number) ". ";
}



/* Finding */
.finding-header th {
    font-weight: normal;
    width: 7em;
}
.finding-header tr {
    break-inside: auto;
}
.finding-header-color{
    font-size: 12pt;
    color: white !important;
}



/*CSS classes for multiple systems */
.finding-systems {
    padding-left: 1em;
}
.finding-systems-cols {
    column-count: 2;
    padding-top: 1em;
    margin-bottom: 1em;
}

.end-of-report {
    text-align:center;
    font-style:italic;
    margin-top:70px;
    line-height:1.7;
}



/* #region header */
@page {
    margin-top: 35mm;

    --header-margin-bottom: 5mm;
    
    @top-left-corner {
        content: "";
        margin-bottom: var(--header-margin-bottom);
        border-bottom: 2px dotted white;
    }
    @top-left { 
        content: element(header-left); 
        margin-bottom: var(--header-margin-bottom);
        border-bottom: 2px dotted white;
        width: 100%;
    }
    @top-right-corner { 
        content: "";
        margin-bottom: var(--header-margin-bottom); 
        border-bottom: 2px dotted white;
    }
}
#header-left { 
    position: running(header-left); 
    display: flex;
    flex-direction: row;
    align-items: center;
}
#header-logo { height: 20mm; }
#header-text { font-size: 14pt; margin-left: -3mm; }
/* #endregion header */

/* #region footer */
@page {
    @bottom-left { content: element(footer-left); }
    @bottom-center { content: element(footer-center); }
    @bottom-right-corner { content: counter(page); }
}
#footer-left { position: running(footer-left); }
#footer-center { position: running(footer-center); }
/* #endregion footer */

/* #region page-cover */
#page-cover-logo {
    position: absolute;
    top: 5%;
    left: 2cm;
    height: 6cm;
    transform: translate(-50%, -50%);
    display: inline-block
}

#page-cover-logo-title {
    position: absolute;
    top: 5%;
    left: 9.5cm;
    transform: translate(-50%, -50%);
    display: inline-block;
    font-size: 42pt;
}

#page-cover-title {
    position: absolute;
    top: 40%;
    left: 50%;
    width: 14cm;
    transform: translate(-50%, -50%);
    text-align: center;
}
#page-cover-title h1 {
    font-size: 32pt;
    color: white;
}
#page-cover-title h2 {
    font-size: 24pt;
    color: white;
}
#page-cover-title h3 {
    font-size: 12pt;
    color: white;
}
#page-cover-report-title{
    color: var(--color-highlight) !important;
}

#page-cover-recipient {
    position: absolute;
    top: 80%;
    left: 50%;
    width: 14cm;
    transform: translate(-50%, -50%);
    display: inline-block;
    text-align: right;
}

#page-cover-recipient h1 {
    font-size: 16pt;
    color: var(--color-highlight);
}
#page-cover-recipient h2 {
    font-size: 12pt;
    color: var(--color-secondary);
}

@page :first {
    /* Hide header */
    @top-left-corner { content: none !important; }
    @top-left { content: none !important; }
    @top-right-corner { content: none !important; }
    /* Hide footer (except "confidential") */
    @bottom-center { content: none !important; }
    @bottom-right-corner { content: none !important; }
}
/* #endregion page-cover */

/* #region toc */
#toc li {
    list-style: none;
    margin: 0;
    padding: 0;
    color: var(--color-secondary);
}
#toc .ref::before {
    padding-right: 0.5em;
}
#toc .ref::after {
    content: " " leader(".") " " target-counter(attr(href), page);
}
#toc .toc-level1 {
    font-size: 14pt;
    margin-top: 0.8em;
    color: white;
}
#toc .toc-level2 {
    font-size: 12pt;
    margin-top: 0.5em;
    margin-left: 1em;
}
#toc .toc-level3 {
    font-size: 10pt;
    margin-top: 0.4em;
    margin-left: 2em;
}
/* #endregion toc */
"""

[report_fields]
[report_fields.title]
type = "string"
label = "Report Title"
origin = "core"
default = "TODO Internal Pentest"
required = true
spellcheck = false

[report_fields.scope]
type = "markdown"
label = "Scope"
origin = "custom"
default = """
The scope of this assessment was as follows:

| **URL**              | **Description**             |
| -------------------- | --------------------------- |
| www.royalflush.htb   | Main RoyalFlush website     |
| git.royalflush.htb   | RoyalFlush Git Repositories |
| forum.royalflush.htb | RoyalFlush Forums           |
| vault.royalflush.htb | RoyalFlush Secure Vault     |
| \\*.securedata.htb    | SecureData web app(s)       |
| \\*.vitamedix.htb     | VitaMedix web app(s)        |
"""
required = true

[report_fields.approach]
type = "markdown"
label = "Approach"
origin = "custom"
default = """
{{ report.candidate.a_name }} performed testing under a mixture of "blackbox" and a "whitebox" approach from {{ formatDate(report.pentest_start, 'long', 'en-US') }} to {{ formatDate(report.pentest_end, 'long', 'en-US') }}, as follows:

<ul><li v-for="customer in report.customers"> <code>{{ customer.customer_short }}</code> <markdown :text="customer.pentest_approach" class="markdown-inline" /></li></ul>

Testing was performed remotely from a non-evasive standpoint, with the goal of uncovering as many misconfigurations and vulnerabilities as possible. Each weakness identified was documented and manually investigated to determine exploitation possibilities and escalation potential.

{{ report.candidate.a_name }} sought to demonstrate the full impact of every vulnerability, up to and including internal network access. Furthermore, {{ report.candidate.a_name }} has also documented the sources of vulnerabilities that were identified through source code analysis, and provided recommended patches to fix them.
"""
required = true

[report_fields.candidate]
type = "object"
label = "HTB Candidate"
origin = "custom"

[report_fields.candidate.properties]
[report_fields.candidate.properties.a_name]
type = "string"
label = "Full Name"
origin = "custom"
default = "TODO Candidate Name"
required = true
spellcheck = false

[report_fields.candidate.properties.a_name.extra_info]

[report_fields.candidate.properties.b_title]
type = "string"
label = "Title"
origin = "custom"
default = "TODO Candidate Title"
required = true
spellcheck = false

[report_fields.candidate.properties.b_title.extra_info]

[report_fields.candidate.properties.c_email]
type = "string"
label = "Email"
origin = "custom"
default = "TODO Candidate Email"
required = true
spellcheck = false

[report_fields.candidate.properties.c_email.extra_info]

[report_fields.customers]
type = "list"
label = "Customers"
origin = "custom"
required = true

[report_fields.customers.items]
type = "object"
label = ""
origin = "custom"

[report_fields.customers.items.extra_info]

[report_fields.customers.items.properties]
[report_fields.customers.items.properties.customer_full]
type = "string"
label = "Customer"
origin = "custom"
default = "TODO Customer Ltd."
required = true
spellcheck = false

[report_fields.customers.items.properties.customer_full.extra_info]

[report_fields.customers.items.properties.customer_short]
type = "string"
label = "Customer (abbreviated)"
origin = "custom"
default = "TODO Customer"
required = true
spellcheck = false

[report_fields.customers.items.properties.customer_short.extra_info]

[report_fields.customers.items.properties.pentest_approach]
type = "markdown"
label = "Pentest Approach"
origin = "custom"
default = "TODO Customer Pentest Approach (Black-Box, White-Box, Grey-Box)"
required = true

[report_fields.customers.items.properties.pentest_approach.extra_info]

[report_fields.pentest_end]
type = "date"
label = "Pentest End"
origin = "custom"
required = true

[report_fields.report_date]
type = "date"
label = "Report Date"
origin = "custom"
required = true

[report_fields.pentest_start]
type = "date"
label = "Pentest Start"
origin = "custom"
required = true

[report_fields.appendix_flags]
type = "markdown"
label = "Flags Discovered"
origin = "custom"
default = """
TODO: fill in any identified flags. 

| Flag # | Application           | Flag Value | Method Used           |
| ------ | --------------------- | ---------- | --------------------- |
| 1.     | **RoyalFlush - Auth** | **HASH**   | **Command Injection** |
| 2.     | **RoyalFlush - RCE**  |            |                       |
| 3.     | **SecureData - Auth** |            |                       |
| 4.     | **SecureData - RCE**  |            |                       |
| 5.     | **VitaMedix - Auth**  |            |                       |
| 6.     | **VitaMedix - RCE**   |            |                       |
"""
required = false

[report_fields.report_version]
type = "string"
label = "Report Version"
origin = "custom"
default = "TODO 1.0"
required = true
spellcheck = false

[report_fields.customer_contacts]
type = "list"
label = "Customer Contacts"
origin = "custom"
required = true

[report_fields.customer_contacts.items]
type = "object"
label = ""
origin = "custom"

[report_fields.customer_contacts.items.extra_info]

[report_fields.customer_contacts.items.properties]
[report_fields.customer_contacts.items.properties.a_name]
type = "string"
label = "Name"
origin = "custom"
default = "TODO Name"
required = true
spellcheck = false

[report_fields.customer_contacts.items.properties.a_name.extra_info]

[report_fields.customer_contacts.items.properties.b_title]
type = "string"
label = "Title"
origin = "custom"
default = "TODO Title"
required = true
spellcheck = false

[report_fields.customer_contacts.items.properties.b_title.extra_info]

[report_fields.customer_contacts.items.properties.c_email]
type = "string"
label = "Email"
origin = "custom"
default = "TODO Email"
required = true
spellcheck = false

[report_fields.customer_contacts.items.properties.c_email.extra_info]

[report_fields.executive_summary]
type = "markdown"
label = "Executive Summary"
origin = "custom"
default = """
{{ report.customers[0]?.customer_full }} (“{{ report.customers[0]?.customer_short }}” herein), {{ report.customers[1]?.customer_full }} (“{{ report.customers[1]?.customer_short }}” herein), and {{ report.customers[2]?.customer_full }} (“{{ report.customers[2]?.customer_short }}” herein) have invited {{ report.candidate.a_name }} to perform a targeted Web Application Penetration Test of their web applications to identify high-risk security weaknesses, assess their impact, document all findings in a clear, professional, and repeatable manner, and provide remediation recommendations.

All web-related findings were considered in-scope, as long as they can be proven harmful to the client with a Medium-High impact. The following types of activities were considered out-of-scope for this test:

* Physical attacks against the clients' properties
* Unverified scanner output
* Any vulnerabilities identified through DDoS or spam attacks
* Vulnerabilities in third-party libraries unless they can be leveraged to impact the target significantly
* Any theoretical attacks or attacks that require significant user interaction or are considered low-risk
"""
required = true

[report_fields.appendix_severities]
type = "markdown"
label = "Finding Severities"
origin = "custom"
default = """
Each finding has been assigned a severity rating of critical, high, medium, low or info. The rating is based off of an assessment of the priority with which each finding should be viewed and the potential impact each has on the confidentiality, integrity, and availability of {{ report.customer_short }}’s data.

| Rating   | CVSS Score Range |
| -------- | ---------------- | 
| Critical | 9.0 – 10.0       |
| High     | 7.0 – 8.9        |
| Medium   | 4.0 – 6.9        |
| Low      | 0.1 – 3.9        |
| Info     | 0.0              |
"""
required = false

[report_fields.appendix_additional_sections]
type = "list"
label = "Additional Appendix"
origin = "custom"
required = false

[report_fields.appendix_additional_sections.items]
type = "object"
label = ""
origin = "custom"

[report_fields.appendix_additional_sections.items.extra_info]

[report_fields.appendix_additional_sections.items.properties]
[report_fields.appendix_additional_sections.items.properties.title]
type = "string"
label = "Title"
origin = "custom"
default = "TODO Appendix Title"
required = true
spellcheck = false

[report_fields.appendix_additional_sections.items.properties.title.extra_info]

[report_fields.appendix_additional_sections.items.properties.content]
type = "markdown"
label = "Content"
origin = "custom"
default = "TODO Additional Appendix"
required = true

[report_fields.appendix_additional_sections.items.properties.content.extra_info]

[report_fields.assessment_overview_and_recommendations]
type = "markdown"
label = "Assessment Overview and Recomendations"
origin = "custom"
default = "TODO: 1 page summary of all identified vulnerabilities, as well as their respective recommended remediations."
required = true

[[report_sections]]
id = "meta"
label = "Meta"
fields = [
    "candidate",
    "title",
    "customers",
    "pentest_start",
    "pentest_end",
    "report_date",
    "report_version",
]

[[report_sections]]
id = "document_control"
label = "Document Control"
fields = [
    "customer_contacts",
]

[[report_sections]]
id = "executive_summary"
label = "Executive Summary"
fields = [
    "executive_summary",
    "approach",
]

[[report_sections]]
id = "scope"
label = "Scope"
fields = [
    "scope",
]

[[report_sections]]
id = "web_application_security_assessment_summary"
label = "Web Application Security Assessment Summary"
fields = [
    "assessment_overview_and_recommendations",
]

[[report_sections]]
id = "appendix"
label = "Appendix"
fields = [
    "appendix_severities",
    "appendix_flags",
    "appendix_additional_sections",
]

[finding_fields]
[finding_fields.title]
type = "string"
label = "Finding Title"
origin = "core"
default = "TODO FINDING TITLE"
required = true
spellcheck = true

[finding_fields.cvss]
type = "cvss"
label = "CVSS 4.0"
origin = "predefined"
default = "n/a"
required = true
cvss_version = "CVSS:4.0"

[finding_fields.summary]
type = "markdown"
label = "Description & Cause"
origin = "predefined"
default = "TODO DESCRIPTION & CAUSE"
required = true

[finding_fields.impact]
type = "markdown"
label = "Security Impact"
origin = "predefined"
default = "TODO SECURITY IMPACT"
required = true

[finding_fields.description]
type = "markdown"
label = "Detailed Walkthrough"
origin = "predefined"
default = """
TODO: Explain in detail how to replicate this finding and how it was identified, and provide detailed steps, screenshots, and commands to support your findings.

TODO: For vulnerabilities identified through source code analysis "whitebox", you also need to include the vulnerable code block and highlight the vulnerable lines of code. Then, you need to explain how this lead to the vulnerability. You do not need to include the entire file, but only the parts that are related to the vulnerability.
"""
required = false

[finding_fields.recommendation]
type = "markdown"
label = "Patching and Remediation"
origin = "predefined"
default = """
TODO: Provide detailed remediation advice to fix the identified vulnerability. The advice needs to be practical with detailed instructions, and not just an overview.

TODO: For vulnerabilities identified through source code analysis "whitebox", you need to provide a recommended patch for each vulnerable code block, while highlighting the applied changes, and explaining how they remediate the issue.
"""
required = true

[finding_fields.cwe]
type = "cwe"
label = "CWE"
origin = "custom"
required = true

[finding_fields.references]
type = "list"
label = "External References"
origin = "predefined"
required = false

[finding_fields.references.items]
type = "string"
label = "Reference"
origin = "predefined"
default = "TODO EXTERNAL REFERENCES"
required = false
spellcheck = false

[finding_fields.references.items.extra_info]

[finding_fields.affected_components]
type = "list"
label = "Affected Component(s)"
origin = "predefined"
required = false

[finding_fields.affected_components.items]
type = "string"
label = "Component"
origin = "predefined"
default = "TODO AFFECTED COMPONENT"
required = true
spellcheck = false

[finding_fields.affected_components.items.extra_info]

[[finding_ordering]]
field = "cvss"
order = "desc"

[[finding_ordering]]
field = "title"
order = "asc"

[report_preview_data]
[report_preview_data.report]
title = "Private Web App Pentest"
pta = "TODO: screenshots of PTA"
draft = true
scope = """
The scope of this assessment was as follows:

| **URL**              | **Description**             |
| -------------------- | --------------------------- |
| www.royalflush.htb   | Main RoyalFlush website     |
| git.royalflush.htb   | RoyalFlush Git Repositories |
| forum.royalflush.htb | RoyalFlush Forums           |
| vault.royalflush.htb | RoyalFlush Secure Vault     |
| \\*.securedata.htb    | SecureData web app(s)       |
| \\*.vitamedix.htb     | VitaMedix web app(s)        |
"""
company = "TODO company"
contact = "TODO: fill field in report"
customer = "TODO company"
duration = "10 Person Days"
end_date = "2022-07-29"
location = "onsite"
portscan = "TODO: results of nmap scans showing open ports"
situation = """
**TODO** Musterkunde betreibt ein großes Computernetz mit vielen Webapplikationen und ist um dessen Sicherheit besorgt. 

Daher plant **TODO Musterkunde** die Durchführung eines Penetrationstests der **TODO Musterprojekt Webapplikation**.
"""
new_field1 = """
TODO: Ausgangslage war ein externer Angreifer, welcher über eine normale Internetverbindung auf die Applikation
zugreift. 
"""
start_date = "2022-07-18"
report_date = "2023-05-31"
short_scope = "die Webapplikation „Beispielapplikation“ (Bsp-App)/Infrastruktur von x IP-Adressen."
company_name = "Musterkunde GmbH"
order_number = "A21xxxxxx"
out_of_scope = "Nicht im Audit-Umfang ist die hinter der Applikation befindliche Serverinfrastruktur."
pentest_type = "web_greybox"
customer_name = "Inlanefreight Ltd."
port_services = "TODO: fill field in report"
receiver_name = "Maximus Demoman"
contact_person = "TODO: Max Mustermann"
lead_pentester = "bc5c9c67-43e3-467f-924b-02bd76807d24"
provided_users = """
This content is also created in a markdown field per report.

* **Admin**: admin1@example.com
* **User**: user1@example.com
* **User**: user2@example.com
"""
report_version = "1.0"
starting_point = """
Ausgangslage war ein externer Angreifer, welcher über eine normale Internetverbindung auf die Applikation
zugreift. 
"""
target_systems = "TODO: fill field in report"
internal_contact = "TODO: fill field in report"
executive_summary = """
{{ report.customers[0]?.customer_full }} (“{{ report.customers[0]?.customer_short }}” herein), {{ report.customers[1]?.customer_full }} (“{{ report.customers[1]?.customer_short }}” herein), and {{ report.customers[2]?.customer_full }} (“{{ report.customers[2]?.customer_short }}” herein) have invited {{ report.candidate.a_name }} to perform a targeted Web Application Penetration Test of their web applications to identify high-risk security weaknesses, assess their impact, document all findings in a clear, professional, and repeatable manner, and provide remediation recommendations.

All web-related findings were considered in-scope, as long as they can be proven harmful to the client with a Medium-High impact. The following types of activities were considered out-of-scope for this test:

* Physical attacks against the clients' properties
* Unverified scanner output
* Any vulnerabilities identified through DDoS or spam attacks
* Vulnerabilities in third-party libraries unless they can be leveraged to impact the target significantly
* Any theoretical attacks or attacks that require significant user interaction or are considered low-risk
"""
receiver_person_name = "vero architecto"
application_appearance = "TODO: screenshots of applications"
customer_short = "RoyalFlush"
customer_full = "Royal Flush Ltd."
approach = """
{{ report.candidate.a_name }} performed testing under a mixture of "blackbox" and a "whitebox" approach from {{ formatDate(report.pentest_start, 'long', 'en-US') }} to {{ formatDate(report.pentest_end, 'long', 'en-US') }}, as follows:

<ul><li v-for="customer in report.customers"> <code>{{ customer.customer_short }}</code> <markdown :text="customer.pentest_approach" class="markdown-inline" /></li></ul>

Testing was performed remotely from a non-evasive standpoint, with the goal of uncovering as many misconfigurations and vulnerabilities as possible. Each weakness identified was documented and manually investigated to determine exploitation possibilities and escalation potential.

{{ report.candidate.a_name }} sought to demonstrate the full impact of every vulnerability, up to and including internal network access. Furthermore, {{ report.candidate.a_name }} has also documented the sources of vulnerabilities that were identified through source code analysis, and provided recommended patches to fix them.
"""
pentest_start = "2023-05-12"
pentest_end = "2023-05-31"
pentest_approach = "WHITEBOX"
assessment_overview = """
During the penetration test against {{ report.customer_short }}, {{ report.candidate.a_name }} identified {{ finding_stats.count_total }} findings that threaten the confidentiality, integrity, and availability of {{ report.customer_short }}’s information systems. The findings were categorized by severity level, with TODO SEVERITY RATINGS HERE {{ finding_stats.count_critical }} of the findings being assigned a critical-risk rating, {{ finding_stats.count_high }} high-risk rating, {{ finding_stats.count_medium }} medium-risk, and {{ finding_stats.count_low }} low risk. There was also {{ finding_stats.count_info }} informational finding related to enhancing security monitoring capabilities within the internal network.

TODO EXECUTIVE SUMMARY HERE

{{ report.customer_short }} should create a remediation plan based on the [Remediation Summary](#remediation-summary) section of this report, addressing all high findings as soon as possible according to the needs of the business. {{ report.customer_short }} should also consider performing periodic vulnerability assessments if they are not already being performed. Once the issues identified in this report have been addressed, a more collaborative, in-depth Active Directory security assessment may help identify additional opportunities to harden the Active Directory environment, making it more difficult for attackers to move around the network and increasing the likelihood that {{ report.customer_short }} will be able to detect and respond to suspicious activity.
"""
contacts = "TODO: fill field in report"
network_summary = "{{ report.candidate.a_name }} began all testing activities from the perspective of an unauthenticated user on the internet. {{ report.customer_short }} provided the tester with network ranges but did not provide additional information such as operating system or configuration information."
finding_summary = "During the course of testing, {{ report.candidate.a_name }} uncovered a total of {{ finding_stats.count_total }} findings that pose a material risk to {{ report.customer_short }}’s information systems. {{ report.candidate.a_name }} also identified {{ finding_stats.count_info }} informational finding that, if addressed, could further strengthen {{ report.customer_short }}’s overall security posture. Informational findings are observations for areas of improvement by the organization and do not represent security vulnerabilities on their own. The below chart provides a summary of the findings by severity level."
walkthrough_summary = "During the course of the assessment {{ report.candidate.a_name }} was able gain a foothold via the external network, move laterally, and compromise the internal network, leading to full administrative control over the TODO INSERT DOMAIN NAME Active Directory domain. The steps below demonstrate the steps taken from initial access to compromise and does not include all vulnerabilities and misconfigurations discovered during the course of testing. Any issues not used as part of the path to compromise are listed as separate, standalone issues in the [Technical Findings Details](#findings) section, ranked by severity level. The intent of this attack chain is to demonstrate to {{ report.customer_short }} the impact of each vulnerability shown in this report and how they fit together to demonstrate the overall risk to the client environment and help to prioritize remediation efforts (i.e., patching two flaws quickly could break up the attack chain while the company works to remediate all issues reported). While other findings shown in this report could be leveraged to gain a similar level of access, this attack chain shows the initial path of least resistance taken by the tester to achieve domain compromise."
walkthrough_details = """
{{ report.candidate.a_name }}performed the following to fully compromise the TODO INSERT DOMAIN NAME domain.

1. TODO LIST HIGH LEVEL STEPS
2. ...

**Detailed reproduction steps for this attack chain are as follows:**

TODO FILL IN DETAILED ATTACK CHAIN STEPS

{{ report.candidate.a_name }}then performed the following to fully compromise the TODO INSERT OTHER INTERNAL DOMAIN NAME(S) domain.

1. TODO LIST HIGH LEVEL STEPS
2. ...

**Detailed reproduction steps for this attack chain are as follows:**

TODO FILL IN DETAILED ATTACK CHAIN STEPS
"""
remediation_summary = "As a result of this assessment there are several opportunities for {{ report.customer_short }} to strengthen its internal network security. Remediation efforts are prioritized below starting with those that will likely take the least amount of time and effort to complete. {{ report.customer_short }} should ensure that all remediation steps and mitigating controls are carefully planned and tested to prevent any service disruptions or loss of data."
short_term = """
TODO SHORT TERM REMEDIATION:
* [Finding Reference 1](#a10eed1a-07f5-46ef-bf3a-b78208e72272) - Set strong (24+ character) passwords on all SPN accounts
* [Finding Reference 2](#89b9d011-8782-4a14-be15-ead66d720936) - TODO FILL IN AS APPROPRIATE
* [Finding Reference 3](#f622369f-782e-4d77-bf2d-493b85747b3b) - Enforce a password change for all users because of the domain compromise

TODO FILL IN BASED ON FINDINGS, EXAMPLES LEFT FOR REFERENCE
"""
medium_term = """
TODO MEDIUM TERM REMEDIATION:
* [Finding Reference 1](#a10eed1a-07f5-46ef-bf3a-b78208e72272) - Disable LLMNR and NBT-NS wherever possible
* [Finding Reference 2](#89b9d011-8782-4a14-be15-ead66d720936) - TODO FILL IN AS APPROPRIATE

TODO FILL IN BASED ON FINDINGS, EXAMPLES LEFT FOR REFERENCE
"""
long_term = """
TODO LONG TERM REMEDIATION:
* Perform ongoing internal network vulnerability assessments and domain password audits
* Perform periodic Active Directory security assessments
* Educate systems and network administrators and developers on security hardening best practices compromise
* Enhance network segmentation to isolate critical hosts and limit the effects of an internal compromise
* TODO FILL IN AS APPROPRIATE

TODO FILL IN BASED ON FINDINGS, EXAMPLES LEFT FOR REFERENCE
"""
candidate1 = "TODO Full Candidate Name"
appendix_hostdiscovery = """
| IP Address | Port | Service | Notes |
| ------- | ------- | ------- | ------- |
| TODO FILL IN AS APPROPRIATE   | Text    | Text    |Text    |

"""
appendix_subdomain_discovery = """
| URL | Description | Discovery Method |
| ------- | ------- | ------- | 
| TODO FILL IN DISCOVERED VHOSTS/SUBDOMAINS   |     |     |
"""
appendix_host_discovery = """
| IP Address | Port | Service | Notes |
| ------- | ------- | ------- | ------- |
| TODO FILL IN AS APPROPRIATE   |     |     |    |

"""
appendix_exploited_hosts = """
| Host | Scope | Method | Notes |
| ------- | ------- | ------- | ------- |
| TODO FILL IN AS APPROPRIATE   | Text    | Text    |Text    |
"""
appendix_compromised_users = """
| Username | Type | Method | Notes |
| ------- | ------- | ------- | ------- |
| TODO FILL IN AS APPROPRIATE   | Text    | Text    |Text    |
"""
appendix_cleanup = """
| Host | Scope | Change/Cleanup Needed |
| ------- | ------- | ------- | 
| TODO FILL IN AS APPROPRIATE   |     |     |
"""
appendix_flags = """
TODO: fill in any identified flags. 

| Flag # | Application           | Flag Value | Method Used           |
| ------ | --------------------- | ---------- | --------------------- |
| 1.     | **RoyalFlush - Auth** | **HASH**   | **Command Injection** |
| 2.     | **RoyalFlush - RCE**  |            |                       |
| 3.     | **SecureData - Auth** |            |                       |
| 4.     | **SecureData - RCE**  |            |                       |
| 5.     | **VitaMedix - Auth**  |            |                       |
| 6.     | **VitaMedix - RCE**   |            |                       |
"""
appendix_severities = """
Each finding has been assigned a severity rating of critical, high, medium, low or info. The rating is based off of an assessment of the priority with which each finding should be viewed and the potential impact each has on the confidentiality, integrity, and availability of {{ report.customer_short }}’s data.

| Rating   | CVSS Score Range |
| -------- | ---------------- | 
| Critical | 9.0 – 10.0       |
| High     | 7.0 – 8.9        |
| Medium   | 4.0 – 6.9        |
| Low      | 0.1 – 3.9        |
| Info     | 0.0              |
"""
appendix_additional_sections = []
summary_of_findings = "During the course of testing, {{ report.candidate.a_name }} uncovered a total of **{{ finding_stats.count_total }}** findings that pose a material risk to client’s web applications and systems. The below chart provides a summary of the findings by severity level."
assessment_overview_and_recommendations = "TODO: 1 page summary of all identified vulnerabilities, as well as their respective recommended remediations."

[[report_preview_data.report.review]]
name = "Collegius Doe"
email = "c.doe@example.com"
mobile = "+43 660 123 456 78"

[report_preview_data.report.company_address]
city = "A-1111 Wien"
street = "Musterstraße 1"

[[report_preview_data.report.list_of_changes]]
description = "Final Report"
date = "2023-05-31"
version = "1.0"

[[report_preview_data.report.list_of_changes]]
description = "Draft"
date = "2023-05-31"
version = "0.1"

[[report_preview_data.report.security_niveau]]
area = "sit illum"
rating = "solid"

[[report_preview_data.report.security_niveau]]
area = "necessitatibus repellat"
rating = "rather_solid"

[[report_preview_data.report.security_niveau]]
area = "asdf"
rating = "improvement_potential"

[[report_preview_data.report.security_niveau]]
area = "sdfg"
rating = "rather_problematic"

[[report_preview_data.report.security_niveau]]
area = "ghkj"
rating = "problematic"

[report_preview_data.report.customer_address]
city = "A-4711 Example"
street = "Demo Street 1"

[[report_preview_data.report.document_history]]
description = "Initiale Berichtsversion"
date = "2022-07-29"
version = "1.0"

[[report_preview_data.report.appendix_sections]]
title = "Host & Service Discovery"
content = """
| IP Address | Port | Service | Notes |
| ------- | ------- | ------- |------- |
| TODO FILL IN AS APPROPRIATE    | Text    | Text    |Text    |

"""

[[report_preview_data.report.appendix_sections]]
title = "Subdomain Discovery"
content = """
| Column1 | Column2 | Column3 |
| ------- | ------- | ------- |
| Text    | Text    | Text    |

"""

[[report_preview_data.report.quality_assurance]]
name = "TODO"
email = "TODO"
mobile = "TODO"

[[report_preview_data.report.quality_assurance]]
name = "TODO"
email = "TODO"
mobile = "TODO"

[report_preview_data.report.wstg_categories_niveau]
apit = "problematic"
athn = "improvement"
athz = "improvement"
busl = "improvement"
clnt = "improvement"
conf = "improvement"
cryp = "improvement"
errh = "solid"
idnt = "improvement"
info = "improvement"
inpv = "problematic"
sess = "improvement"

[[report_preview_data.report.customer_contacts]]
a_name = "Yelon Husk"
b_title = "Chief Executive Officer"
c_email = "yelon@royalflush.htb"

[[report_preview_data.report.customer_contacts]]
a_name = "Zeyad AlMadani"
b_title = "Chief Technical Officer"
c_email = "zeyad@securedata.htb"

[[report_preview_data.report.assessor_contacts]]
a_name = "Hack The Box Academy"
b_title = "Security Consultant"
c_email = "someone@htbacademy.local"

[report_preview_data.report.candidate]
a_name = "<CANDIDATE NAME>"
b_title = "Security Consultant"
c_email = "<CANDIDATE MAIL>"

[[report_preview_data.report.appendix_other_sections]]
title = "TODO Appendix Title"
content = "TODO Additional Appendix"

[[report_preview_data.report.appendix_other_sections]]
title = "TODO Appendix Title"
content = "TODO Additional Appendix"

[[report_preview_data.report.customers]]
customer_full = "Royal Flush Ltd."
customer_short = "RoyalFlush"
pentest_approach = "A whitebox penetration test was carried against their targets, with access to their web applications' source code on [http://git.royalflush.htb/](http://git.royalflush.htb/)."

[[report_preview_data.report.customers]]
customer_full = "Secure Data Ltd."
customer_short = "SecureData"
pentest_approach = "A blackbox penetration test was performed, with no further details or access to their web applications."

[[report_preview_data.report.customers]]
customer_full = "Vita Medix Ltd."
customer_short = "VitaMedix"
pentest_approach = "A mixture of blackbox and whitebox was carried against all web applications under their sub-domains."

[[report_preview_data.findings]]
title = "TODO FINDING TITLE"
cvss = "n/a"
summary = "TODO DESCRIPTION & CAUSE"
impact = "TODO SECURITY IMPACT"
description = """
TODO: Explain in detail how to replicate this finding and how it was identified, and provide detailed steps, screenshots, and commands to support your findings.

TODO: For vulnerabilities identified through source code analysis "whitebox", you also need to include the vulnerable code block and highlight the vulnerable lines of code. Then, you need to explain how this lead to the vulnerability. You do not need to include the entire file, but only the parts that are related to the vulnerability.
"""
recommendation = """
TODO: Provide detailed remediation advice to fix the identified vulnerability. The advice needs to be practical with detailed instructions, and not just an overview.

TODO: For vulnerabilities identified through source code analysis "whitebox", you need to provide a recommended patch for each vulnerable code block, while highlighting the applied changes, and explaining how they remediate the issue.
"""
id = "bfc6e2b5-05ba-4b2b-bad9-c2bcc564d969"
cwe = "CWE-89"
references = [
    "TODO EXTERNAL REFERENCES",
]
affected_components = [
    "TODO AFFECTED COMPONENT",
]
order = 1

[[assets]]
id = "d7cfa08d-597f-4a14-b259-1395545c9b67"
created = "2023-05-18T08:05:56.908459Z"
updated = "2024-02-21T14:53:41.377191Z"
name = "logo-transparent.png"
